<div class="bg-white rounded-xl shadow-lg overflow-hidden border-t-4" [ngClass]="getListBorderClass()"
  (dragover)="onDragOver($event)" (drop)="onDrop($event)">
  <!-- Header de la lista -->
  <div class="p-4 border-b border-gray-100">
    <div class="flex items-center justify-between mb-2">
      <h3 class="text-lg font-semibold text-gray-800">{{ list.name }}</h3>
      <div class="flex items-center gap-2">
        <div class="flex items-center gap-2">
          <!-- Indicadores de prioridad de tareas -->
          @if (priorityStats().urgent > 0) {
          <span class="text-xs px-2 py-1 bg-error bg-opacity-20 text-red-700 rounded-full">
            🔴 {{ priorityStats().urgent }}
          </span>
          }
          @if (priorityStats().high > 0) {
          <span class="text-xs px-2 py-1 bg-warning bg-opacity-20 text-yellow-700 rounded-full">
            🟠 {{ priorityStats().high }}
          </span>
          }
        </div>
        <button (click)="toggleOptions()" class="text-gray-400 hover:text-gray-600 p-1 rounded">
          <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
            <path d="M10 6a2 2 0 110-4 2 2 0 010 4zM10 12a2 2 0 110-4 2 2 0 010 4zM10 18a2 2 0 110-4 2 2 0 010 4z">
            </path>
          </svg>
        </button>
      </div>
    </div>

    <div class="flex items-center justify-between text-sm text-gray-500">
      <span>{{ list.tasks.length }} tareas</span>
      <span>{{ formatDate(list.createdAt) }}</span>
    </div>

    <!-- Opciones de la lista -->
    @if (showOptions()) {
    <div class="mt-3 pt-3 border-t border-gray-100">
      <button (click)="deleteList()"
        class="text-error text-sm hover:bg-error hover:bg-opacity-10 px-2 py-1 rounded transition-colors">
        Eliminar Lista
      </button>
    </div>
    }
  </div>

  <!-- Formulario para agregar tarea -->
  <div class="p-4 border-b border-gray-100">
    <div class="space-y-2">
      <input type="text" placeholder="Agregar nueva tarea..." [(ngModel)]="newTaskDescription"
        (keyup.enter)="createTask()"
        class="w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent" />
      <div class="flex gap-2">
        <select [(ngModel)]="selectedTaskPriority"
          class="flex-1 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent">
          <option value="low">🟢 Baja prioridad</option>
          <option value="medium">🟡 Media prioridad</option>
          <option value="high">🟠 Alta prioridad</option>
          <option value="urgent">🔴 Urgente</option>
        </select>
        <button (click)="createTask()" [disabled]="!newTaskDescription().trim()"
          class="px-4 py-1 bg-primary text-white text-sm rounded-lg hover:bg-primary-dark disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors">
          Agregar
        </button>
      </div>
    </div>
  </div>

  <!-- Lista de tareas -->
  <div class="max-h-96 overflow-y-auto">
    @if (list.tasks.length === 0) {
    <div class="p-8 text-center text-gray-400">
      <div class="text-3xl mb-2">📝</div>
      <p class="text-sm">No hay tareas aquí</p>
      <p class="text-xs">Agrega una tarea o arrastra una existente</p>
    </div>
    } @else {
    <div class="p-2 space-y-2">
      @for (task of (list.tasks | sortTasks); track task.id) {
      <app-card [task]="task" (taskMoved)="onTaskMoved($event)" (taskDeleted)="onTaskDeleted($event)"
        (taskCompleted)="onTaskCompleted($event)" />
      }
    </div>
    }
  </div>
</div>